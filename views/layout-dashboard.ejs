<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HMS Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/dashboard.css">
</head>
<body>

    <div class="sidebar">
        <div class="brand">
            <i class="bi bi-buildings-fill text-primary"></i> HMS Portal
        </div>

        <ul class="nav-links">
            <% if (user.role === 'admin') { %>
                <li class="nav-item">
                    <a href="/admin/dashboard" class="nav-link <%= (typeof section !== 'undefined' && section === 'dashboard') ? 'active' : '' %>">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/dashboard?section=rooms" class="nav-link <%= (typeof section !== 'undefined' && section === 'rooms') ? 'active' : '' %>">
                        <i class="bi bi-door-open"></i> Rooms
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/dashboard?section=students" class="nav-link <%= (typeof section !== 'undefined' && section === 'students') ? 'active' : '' %>">
                        <i class="bi bi-people"></i> Students
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/dashboard?section=staff" class="nav-link <%= (typeof section !== 'undefined' && section === 'staff') ? 'active' : '' %>">
                        <i class="bi bi-person-badge"></i> Staff
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/dashboard?section=complaints" class="nav-link <%= (typeof section !== 'undefined' && section === 'complaints') ? 'active' : '' %>">
                        <i class="bi bi-exclamation-circle"></i> Complaints
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin/dashboard?section=gallery" class="nav-link <%= (typeof section !== 'undefined' && section === 'gallery') ? 'active' : '' %>">
                        <i class="bi bi-images"></i> Gallery
                    </a>
                </li>
            <% } %>

            <% if (user.role === 'staff') { %>
                <li class="nav-item">
                    <a href="/staff/dashboard" class="nav-link active">
                        <i class="bi bi-grid"></i> Dashboard
                    </a>
                </li>
            <% } %>

            <% if (user.role === 'student') { %>
                <li class="nav-item">
                    <a href="/student/dashboard" class="nav-link active">
                        <i class="bi bi-person-circle"></i> My Profile
                    </a>
                </li>
            <% } %>
        </ul>

        <div style="margin-top: auto;">
            <a href="/users/logout" class="nav-link text-danger">
                <i class="bi bi-box-arrow-right"></i> Logout
            </a>
        </div>
    </div>

    <div class="main-content">
        <div class="top-header">
            <div>
                <h4 class="m-0">Welcome, <%= user.name.split(' ')[0] %> ðŸ‘‹</h4>
                <small class="text-muted text-uppercase"><%= user.role %></small>
            </div>
            <div class="user-profile">
                <img src="<%= user.profilePic || 'https://ui-avatars.com/api/?name='+user.name+'&background=0d6efd&color=fff' %>" class="avatar-md shadow-sm" alt="Profile">
            </div>
        </div>

        <% if(success_msg != ''){ %>
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="bi bi-check-circle-fill me-2"></i> <%= success_msg %>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        <% } %>
        
        <% if(error_msg != ''){ %>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i> <%= error_msg %>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        <% } %>

        <% if(error != ''){ %>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="bi bi-exclamation-circle-fill me-2"></i> <%= error %>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        <% } %>

        <%- body %>

        <div class="text-center text-muted mt-5 mb-3 small">
            &copy; <%= new Date().getFullYear() %> HMS Portal. All rights reserved.
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
